# Kiro è´¦å·ç®¡ç†å™¨ - æœ€ç»ˆçŠ¶æ€

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### 1. ç»„ä»¶å¯¼å…¥é”™è¯¯ï¼ˆæ ¹æœ¬åŸå› ï¼‰
**é—®é¢˜**ï¼š`SettingsPanel.vue` å¯¼å…¥çš„æ˜¯ `KiroAccountManagerEnhanced.vue`ï¼ˆä¸å®Œæ•´çš„å®ç°ï¼‰ï¼Œè€Œä¸æ˜¯ `KiroAccountManager.vue`ï¼ˆå®Œæ•´çš„å®ç°ï¼‰

**ä¿®å¤**ï¼š
```vue
// ä¿®æ”¹å‰
import KiroAccountManager from './KiroAccountManagerEnhanced.vue'

// ä¿®æ”¹å
import KiroAccountManager from './KiroAccountManager.vue'
```

### 2. æ·»åŠ è¯¦ç»†æ—¥å¿—
ä¸ºæ‰€æœ‰ API æ–¹æ³•æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºï¼Œä¾¿äºè°ƒè¯•ï¼š
- `GetKiroAccounts()` - è·å–è´¦å·åˆ—è¡¨
- `AddKiroAccount()` - æ·»åŠ è´¦å·
- `RemoveKiroAccount()` - åˆ é™¤è´¦å·
- `UpdateKiroAccount()` - æ›´æ–°è´¦å·
- `SwitchKiroAccount()` - åˆ‡æ¢è´¦å·

### 3. ä»£ç é‡å¤é—®é¢˜
æ¸…ç†äº† `app.go` ä¸­çš„é‡å¤ä»£ç 

## ğŸ¯ å½“å‰åŠŸèƒ½çŠ¶æ€

### âœ… å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡
1. **æ·»åŠ è´¦å·** - é€šè¿‡ Refresh Token æ·»åŠ è´¦å·
2. **Kiro API é›†æˆ** - æ­£ç¡®è°ƒç”¨ Kiro Auth å’Œ Usage API
3. **æ•°æ®å­˜å‚¨** - åŠ å¯†å­˜å‚¨åˆ° `~/.config/opencode/data/accounts.json.enc`
4. **è´¦å·åˆ—è¡¨æ˜¾ç¤º** - æ˜¾ç¤ºé‚®ç®±ã€è®¢é˜…ç±»å‹ã€é…é¢ä¿¡æ¯

### âš ï¸ éœ€è¦æµ‹è¯•
1. **åˆ é™¤è´¦å·** - ä»£ç å·²å®ç°ï¼Œéœ€è¦æµ‹è¯•
2. **åˆ‡æ¢è´¦å·** - ä»£ç å·²å®ç°ï¼Œéœ€è¦æµ‹è¯•
3. **ç¼–è¾‘è´¦å·** - ä»£ç å·²å®ç°ï¼Œéœ€è¦æµ‹è¯•

### ğŸ”§ ç•Œé¢é—®é¢˜
ç”¨æˆ·åé¦ˆ"çœ‹ä¸å…¨ç•Œé¢"ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´ï¼š
- æ»šåŠ¨æ¡
- å®¹å™¨é«˜åº¦
- å“åº”å¼å¸ƒå±€

## ğŸ“ æµ‹è¯•æ­¥éª¤

### 1. é‡æ–°å¯åŠ¨åº”ç”¨
```bash
cd myapp
wails dev
```

### 2. æµ‹è¯•æ·»åŠ è´¦å·
1. æ‰“å¼€è®¾ç½® â†’ Kiro è´¦å·
2. ç‚¹å‡»"æ·»åŠ è´¦å·"
3. è¾“å…¥ Refresh Token
4. ç‚¹å‡»"æ·»åŠ è´¦å·"
5. æŸ¥çœ‹ç»ˆç«¯æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
   ```
   API è°ƒç”¨: AddKiroAccount (method=token)
   â†’ addAccountByToken å¼€å§‹
   ...
   âœ“ è´¦å·æ·»åŠ æˆåŠŸ
   ```

### 3. æµ‹è¯•åˆ é™¤è´¦å·
1. ç‚¹å‡»è´¦å·å¡ç‰‡ä¸Šçš„åˆ é™¤æŒ‰é’®ï¼ˆåƒåœ¾æ¡¶å›¾æ ‡ï¼‰
2. ç¡®è®¤åˆ é™¤
3. æŸ¥çœ‹ç»ˆç«¯æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
   ```
   API è°ƒç”¨: RemoveKiroAccount (id=xxx)
   âœ“ è´¦å·åˆ é™¤æˆåŠŸ
   ```

### 4. æµ‹è¯•åˆ‡æ¢è´¦å·
1. ç‚¹å‡»è´¦å·å¡ç‰‡ä¸Šçš„"åˆ‡æ¢"æŒ‰é’®
2. æŸ¥çœ‹ç»ˆç«¯æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
   ```
   API è°ƒç”¨: SwitchKiroAccount (id=xxx)
   âœ“ è´¦å·åˆ‡æ¢æˆåŠŸ
   ```
3. éªŒè¯ Token æ–‡ä»¶å·²æ›´æ–°ï¼š
   ```bash
   cat ~/.aws/sso/cache/kiro-auth-token.json
   ```

### 5. éªŒè¯æ•°æ®æŒä¹…åŒ–
```bash
# æ£€æŸ¥æ•°æ®æ–‡ä»¶
ls -la ~/.config/opencode/data/accounts.json.enc

# é‡å¯åº”ç”¨åè´¦å·åº”è¯¥è¿˜åœ¨
```

## ğŸ› å¦‚æœåŠŸèƒ½ä¸å·¥ä½œ

### åˆ é™¤åŠŸèƒ½ä¸å·¥ä½œ
**æŸ¥çœ‹ç»ˆç«¯æ—¥å¿—**ï¼š
- å¦‚æœçœ‹åˆ° `API è°ƒç”¨: RemoveKiroAccount`ï¼Œè¯´æ˜å‰ç«¯è°ƒç”¨æˆåŠŸ
- å¦‚æœçœ‹åˆ°é”™è¯¯ä¿¡æ¯ï¼Œæ ¹æ®é”™è¯¯ä¿®å¤

**å¯èƒ½çš„åŸå› **ï¼š
1. å‰ç«¯æ²¡æœ‰æ­£ç¡®è°ƒç”¨ API
2. è´¦å· ID ä¸æ­£ç¡®
3. æƒé™é—®é¢˜

### åˆ‡æ¢åŠŸèƒ½ä¸å·¥ä½œ
**æŸ¥çœ‹ç»ˆç«¯æ—¥å¿—**ï¼š
- å¦‚æœçœ‹åˆ° `API è°ƒç”¨: SwitchKiroAccount`ï¼Œè¯´æ˜å‰ç«¯è°ƒç”¨æˆåŠŸ
- å¦‚æœçœ‹åˆ°é”™è¯¯ä¿¡æ¯ï¼Œæ ¹æ®é”™è¯¯ä¿®å¤

**å¯èƒ½çš„åŸå› **ï¼š
1. Token æ–‡ä»¶å†™å…¥å¤±è´¥ï¼ˆæƒé™é—®é¢˜ï¼‰
2. Machine ID æ›´æ–°å¤±è´¥
3. è´¦å· ID ä¸æ­£ç¡®

### ç•Œé¢æ˜¾ç¤ºä¸å…¨
**å¯èƒ½çš„åŸå› **ï¼š
1. å®¹å™¨é«˜åº¦é™åˆ¶
2. ç¼ºå°‘æ»šåŠ¨æ¡
3. CSS æ ·å¼é—®é¢˜

**ä¸´æ—¶è§£å†³æ–¹æ¡ˆ**ï¼š
- è°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°
- ä½¿ç”¨æµè§ˆå™¨çš„ç¼©æ”¾åŠŸèƒ½ï¼ˆCtrl/Cmd + -ï¼‰

## ğŸ“Š API ç«¯ç‚¹

### Kiro Auth API
- **Base URL**: `https://prod.us-east-1.auth.desktop.kiro.dev`
- **åˆ·æ–° Token**: `POST /refreshToken`

### Kiro Usage API
- **Base URL**: `https://codewhisperer.us-east-1.amazonaws.com`
- **è·å–é…é¢**: `GET /getUsageLimits`

## ğŸ“ é‡è¦æ–‡ä»¶

### åç«¯
- `myapp/app.go` - Wails API æ–¹æ³•
- `myapp/kiro_api_real.go` - Kiro API å®¢æˆ·ç«¯
- `myapp/account_manager.go` - è´¦å·ç®¡ç†å™¨
- `myapp/kiro_system.go` - ç³»ç»Ÿé›†æˆï¼ˆå†™å…¥ Tokenï¼‰

### å‰ç«¯
- `myapp/frontend/src/components/SettingsPanel.vue` - è®¾ç½®é¢æ¿
- `myapp/frontend/src/components/KiroAccountManager.vue` - è´¦å·ç®¡ç†ç»„ä»¶ï¼ˆæ­£åœ¨ä½¿ç”¨ï¼‰
- `myapp/frontend/src/components/KiroAccountManagerEnhanced.vue` - å¢å¼ºç‰ˆï¼ˆæœªä½¿ç”¨ï¼‰

### æ•°æ®æ–‡ä»¶
- `~/.config/opencode/data/accounts.json.enc` - è´¦å·æ•°æ®ï¼ˆåŠ å¯†ï¼‰
- `~/.aws/sso/cache/kiro-auth-token.json` - å½“å‰æ¿€æ´»è´¦å·çš„ Token

## ğŸ” è°ƒè¯•å‘½ä»¤

```bash
# æŸ¥çœ‹æ•°æ®æ–‡ä»¶
ls -la ~/.config/opencode/data/

# æŸ¥çœ‹ Token æ–‡ä»¶
cat ~/.aws/sso/cache/kiro-auth-token.json

# å®Œæ•´ç¯å¢ƒæ£€æŸ¥
cd myapp && ./verify_kiro_setup.sh

# æŸ¥çœ‹åº”ç”¨è¿›ç¨‹
ps aux | grep myapp

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
# åœ¨è¿è¡Œ wails dev çš„ç»ˆç«¯ä¸­æŸ¥çœ‹
```

## ğŸ“ ä¸‹ä¸€æ­¥

1. **æµ‹è¯•åˆ é™¤å’Œåˆ‡æ¢åŠŸèƒ½**
2. **ä¿®å¤ç•Œé¢æ˜¾ç¤ºé—®é¢˜**ï¼ˆå¦‚æœéœ€è¦ï¼‰
3. **æµ‹è¯•æ•°æ®æŒä¹…åŒ–**
4. **æµ‹è¯•å¤šè´¦å·åˆ‡æ¢**
5. **éªŒè¯ Token è‡ªåŠ¨åˆ·æ–°**ï¼ˆå¦‚æœå®ç°äº†ï¼‰

## ğŸ’¡ æç¤º

- æ‰€æœ‰æ“ä½œéƒ½ä¼šåœ¨ç»ˆç«¯è¾“å‡ºè¯¦ç»†æ—¥å¿—
- å¦‚æœåŠŸèƒ½ä¸å·¥ä½œï¼Œé¦–å…ˆæŸ¥çœ‹ç»ˆç«¯æ—¥å¿—
- æ•°æ®æ–‡ä»¶æ˜¯åŠ å¯†çš„ï¼Œæ— æ³•ç›´æ¥æŸ¥çœ‹å†…å®¹
- Token æ–‡ä»¶æ˜¯æ˜æ–‡çš„ï¼Œå¯ä»¥ç›´æ¥æŸ¥çœ‹
